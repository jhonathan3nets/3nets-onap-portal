<!--
  ================================================================================
  eCOMP Portal
  ================================================================================
  Copyright (C) 2017 AT&T Intellectual Property
  ================================================================================
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at
  
       http://www.apache.org/licenses/LICENSE-2.0
  
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
  ================================================================================
  -->
<div class="application-details-modal">
    <div class="title">Application Details</div>
    <div class="app-properties-main" scroll-top="appDetails.scrollApi">
        <form name="appForm" novalidate autocomplete="off">
            <script type="text/javascript">
                document.getElementById("appForm").reset();
            </script>
            <div class="left-container">
                <div class="property">
                    <input id="checkbox-app-is-restricted" type="checkbox" class="checkbox-field" ng-disabled="appDetails.isEditMode" ng-model="appDetails.app.restrictedApp" ng-checked="appDetails.app.restrictedApp"/>
                    <div class="property-label checkbox-label">Hyperlink only application</div>
                </div>
                <div class="property required">
                    <div class="property-label">Application Name</div>
                    <input id="input-app-name" class="input-field" type="text"
                           ng-model="appDetails.app.name"
                           maxlength="100"
                           name="name"
                           ng-pattern="/^[a-zA-Z0-9_\-\s\&]*$/"
                           required/>
                    <div id="error-container-conflict" class="error-container" ng-show="appDetails.conflictMessages.name" id="conflictMessages-name">
                        <small id="app-name-error-conflict" class="err-message" ng-bind="appDetails.conflictMessages.name"></small>
                    </div>
                    <div id="error-container-edit" class="error-container" ng-show="appForm.name.$dirty || appDetails.isEditMode">
                        <div ng-messages="appForm.name.$error" class="error-container">
                            <small id="app-name-error-required" class="err-message" ng-message="required">Application name is required</small>
                            <small id="app-name-error-alpha-num" class="err-message" ng-message="pattern">Application name must be alphanumeric</small>
                        </div>
                    </div>
                </div>
                <div class="property required">
                    <div id="url-property-label" class="property-label">URL</div>
                    <input class="input-field" id="input-app-url"
                           ng-model="appDetails.app.url"
                           maxlength="256"
                           name="url"
                           type="url" placeholder="https://"
                           ng-pattern="appDetails.ECOMP_URL_REGEX"
                           required />
                    <div class="error-container" ng-show="appDetails.conflictMessages.url" id="div-app-name-err-url">
                        <small class="err-message" ng-bind="appDetails.conflictMessages.url"></small>
                    </div>
                    <div class="error-container" ng-show="appForm.url.$dirty || appDetails.isEditMode">
                        <div ng-messages="appForm.url.$error" class="error-container">
                            <small id="error-app-url-req" class="err-message" ng-message="required">Application URL is required</small>
                            <small id="error-app-url-invalid" class="err-message" ng-show="appForm.url.$error.url">Application URL must be a valid URL</small>
                        </div>
                    </div>
                </div>
               
                <div class="property" ng-show="!appDetails.app.restrictedApp">
                    <div class="property-label">Rest API URL</div>
                    <input class="input-field" id="input-app-rest-url"
                           ng-model="appDetails.app.restUrl"
                           name="restUrl"
                           type="url" placeholder="https://"
                           ng-pattern="appDetails.ECOMP_URL_REGEX"
                           maxlength="256"/>
                    <div class="error-container" ng-show="appForm.restUrl.$dirty || appDetails.isEditMode">
                        <div ng-messages="appForm.restUrl.$error" class="error-container">
                            <small class="err-message" ng-show="appForm.restUrl.$error.url">Application REST URL must be a valid URL</small>
                        </div>
                    </div>
                </div>
                
                <div class="property required" ng-show="!appDetails.app.restrictedApp">
                    <div id="username-property-label"  class="property-label">Username</div>
                    <input class="input-field" type="text"
                           ng-model="appDetails.app.username"
                           name="username"
                           maxlength="256"
                           ng-required="!appDetails.app.restrictedApp"/>
                    <div class="error-container" ng-show="appForm.username.$dirty || appDetails.isEditMode">
                        <div ng-messages="appForm.username.$error" class="error-container">
                            <small  id="error-appusername-reqd" class="err-message" ng-message="required">Rest Api Username is required</small>
                        </div>
                    </div>
                </div>

                <div class="property required" ng-show="!appDetails.app.restrictedApp">
                    <div id="pwd-property-label"  class="property-label">Password</div>
                    <input class="input-field" type="password"  id="input-mylogins-password"
                           ng-model="appDetails.app.appPassword" autocomplete="new-password"
                           name="appPassword"
                           maxlength="256"
                           ng-required="!appDetails.app.restrictedApp"/>
                    <div class="error-container" ng-show="appForm.appPassword.$dirty || appDetails.isEditMode">
                        <div ng-messages="appForm.appPassword.$error" class="error-container">
                            <small id="error-mylogins-password-reqd" class="err-message" ng-message="required">Rest Api Password is required</small>
                        </div>
                    </div>
                </div>


                <div class="property" ng-show="!appDetails.app.restrictedApp">
                    <div class="property-label">Communication Inbox</div>
                    <input class="input-field" type="text" id="input-UEB-topicname"
                           ng-model="appDetails.app.uebTopicName"
                           name="uebTopicName" readonly="readonly"/>
                </div>
                <div class="property" ng-show="!appDetails.app.restrictedApp">
                    <div class="property-label">Communication Key</div>
                    <input class="input-field" type="text" id="input-UEB-communication-key"
                           ng-model="appDetails.app.uebKey"
                           name="uebKey" readonly="readonly" />
                </div>
                <div class="property" ng-show="!appDetails.app.restrictedApp">
                    <div class="property-label">Communication Secret</div>
                    <input class="input-field" type="text" id="input-UEB-communication-secret"
                           ng-model="appDetails.app.uebSecret"
                           name="uebSecret" readonly="readonly" />
                </div>

            </div>
            <div class="right-container">
                <div class="property">
                    <div class="property-label">Upload Image</div>
                    <input type="file" id="input-app-image-upload"
                           class="input-file-field"
                           accept="image/*"
                           ng-model="appDetails.originalImage"
                           name="appImage"
                           image-upload="appDetails.originalImage"
                           image-upload-resize-max-height="300"
                           image-upload-resize-max-width="360"
                           image-upload-resize-quality="0.7"
                           image-upload-api="appDetails.imageApi"/>

                    <div class="error-container" ng-show="appForm.appImage.$dirty">
                        <div ng-messages="appForm.appImage.$error" class="error-container">
                            <small id="error-app-invalid-image" class="err-message" ng-message="mimeType">Uploaded file must be an image</small>
                            <small id="error-app-invalid-image-size" class="err-message" ng-message="imageSize">Image file must be smaller than 1MB</small>
                        </div>
                    </div>
                    <div class="property-label preview">
                        <span class="left-label">Preview</span>
                        <span class="remove" ng-click="appDetails.removeImage()">Remove</span>
                    </div>
                    <img id="image-app-preview" class="image-preview" ng-src="{{appDetails.app.imageUrl || appDetails.app.thumbnail || appDetails.emptyImgForPreview}}"/>

                    <div class="property">
                        <input id="checkbox-app-is-open" type="checkbox" class="checkbox-field" ng-model="appDetails.app.isOpen" ng-checked="appDetails.app.isOpen || appDetails.app.restrictedApp" ng-disabled="appDetails.app.restrictedApp" />
                        <div class="property-label checkbox-label">Allow guest access</div>
                    </div>
                    <div class="property">
                        <input id="checkbox-app-is-enabled" type="checkbox" class="checkbox-field" ng-model="appDetails.app.isEnabled"/>
                        <div class="property-label checkbox-label">Active</div>
                    </div>
                </div>
            </div>
        </form>
    </div>
    <div class="dialog-control">
        <span class="ecomp-save-spinner" ng-show="appDetails.isSaving"></span>
        <div id="button-save-app" class="next-button" ng-class="{disabled: appForm.$invalid}" ng-click="appDetails.saveChanges()">Save</div>
        <div id="button-app-cancel" class="cancel-button" ng-click="closeThisDialog()">Cancel</div>
    </div>
</div>

<script type="application/javascript">
    $(document).ready(function(){
        $(".ngdialog-content").css("top","-150px")
    });
</script>
